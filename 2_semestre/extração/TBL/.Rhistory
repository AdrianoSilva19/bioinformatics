knitr::opts_chunk$set(echo = TRUE)
meta_cachexia = read.table("http://darwin.di.uminho.pt/dataAnalysisR/meta_cachexia.csv", sep = ",", header = T, row.names = 1)
cachexia = read.table("http://darwin.di.uminho.pt/dataAnalysisR/cachexia.csv", sep = ",", header = T, row.names = 1)
cachexia = cbind(cachexia, meta_cachexia)
View(meta_cachexia)
cachexia.log = cachexia %>% select(-Muscle.loss) %>% log2 %>% mutate(meta_cachexia)
library(car)
library(dplyr)
library(purrr)
library(car)
library(dplyr)
library(purrr)
meta_cachexia = read.table("http://darwin.di.uminho.pt/dataAnalysisR/meta_cachexia.csv", sep = ",", header = T, row.names = 1)
cachexia = read.table("http://darwin.di.uminho.pt/dataAnalysisR/cachexia.csv", sep = ",", header = T, row.names = 1)
cachexia = cbind(cachexia, meta_cachexia)
cachexia.log = cachexia %>% select(-Muscle.loss) %>% log2 %>% mutate(meta_cachexia)
View(cachexia.log)
View(cachexia)
pv.orig = cachexia %>% select(-Muscle.loss) %>% map(~ shapiro.test(.x)$p.value) %>% unlist
sum(pv.orig < 0.05)
pv.log = cachexia.log %>% select(-Muscle.loss) %>% map(~ shapiro.test(.x)$p.value) %>% unlist
sum(pv.log < 0.05)
colnames(cachexia.log)[which(pv.log < 0.05)]
View(meta_cachexia)
pv_origin.bh = p.adjust(pv.orig, "BH")
sum(pv_origin.bh < 0.05)
pv_log.bh = p.adjust(pv.log, "BH")
sum(pv_log.bh < 0.05)
pv_origin.bh = p.adjust(pv.orig, "bonferroni")
sum(pv_origin.bh < 0.05)
pv_log.bh = p.adjust(pv.log, "bonferroni")
sum(pv_log.bh < 0.05)
genes = cachexia %>% select(-Muscle.loss)
pvs = genes %>% map_dbl(~ pairwise.t.test(.x, g = cachexia$Muscle.loss)$p.value)
names(pvs) = names(genes)
pvs = pvs[pvs < 0.05]
pvs = pvs[order(pvs)]
length(pvs)
names(pvs)
is_null(genes)
boxplot(genes)
boxplot(genes)
rank = names(pvs)[1:10]
C = round(cor(cachexia[,rank]), 2)
gene.names = C %>% rownames
which(C > 0.7, arr.ind = TRUE) %>% as_tibble %>% filter(row != col) %>% apply(2, function(x) gene.names[x])
heatmap(C, col = hcl.colors(20, palette = "viridis"))
lm1= lm(Leucine ~ Valine, data = cachexia)
lm2= lm(Leucine ~ Valine + X3.Hydroxybutyrate, data = cachexia)
lm3= lm(Leucine ~ Valine * X3.Hydroxybutyrate, data = cachexia)
for(Fit in list(lm1, lm2, lm3)) {
Fit %>% plot(which = 2)
print("Residuos")
residuos = Fit %>% residuals
print(residuos %>% summary)
residuos %>% hist(breaks = 20, prob = T)
residuos %>% density %>% lines
print(Fit %>% summary)
}
